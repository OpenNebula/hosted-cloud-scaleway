#!/bin/bash

# Static VNM clean-hook script for the web frontend
# Generated by Terraform from module 004.

LOG_FILE="/var/log/one/vnm_hook.log"

echo "Executing static VNM clean-hook for web server" >> $LOG_FILE

# The values below are injected by Terraform during the apply phase.
ip route del ${flexible_public_ip} via ${gateway_ip} dev br0

if [ $? -eq 0 ]; then
    echo "Successfully deleted route for ${flexible_public_ip}" >> $LOG_FILE
else
    # Don't exit with 1, as the route might have been already removed.
    # A failure here shouldn't block the VM shutdown process.
    echo "Warning: could not delete route for ${flexible_public_ip}. It might have been already removed." >> $LOG_FILE
fi

exit 0
