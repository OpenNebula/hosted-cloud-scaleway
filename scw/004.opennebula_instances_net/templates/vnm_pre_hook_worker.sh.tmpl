#!/bin/bash

# Static VNM pre-hook script for a worker node
# Generated by Terraform from module 004.

LOG_FILE="/var/log/one/vnm_hook.log"

echo "Executing static VNM pre-hook for worker node" >> $LOG_FILE

# The values below are injected by Terraform during the apply phase.
ip route add ${flexible_public_ip} via ${gateway_ip} dev br0

if [ $? -eq 0 ]; then
    echo "Successfully added route for ${flexible_public_ip} via ${gateway_ip} on br0" >> $LOG_FILE
else
    echo "Error adding route for ${flexible_public_ip}" >> $LOG_FILE
    exit 1
fi

exit 0
